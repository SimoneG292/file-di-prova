<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Test AR con Video</title>
    <script src="https://aframe.io/releases/1.2.0/aframe.min.js"></script>
    <script src="https://cdn.jsdelivr.net/gh/jeromeetienne/AR.js/aframe/build/aframe-ar.js"></script>
</head>
<body style="margin: 0; overflow: hidden;">

    <!-- Scena AR -->
    <a-scene embedded arjs="sourceType: webcam; debugUIEnabled: true; trackingMethod: best;">
        
        <!-- Piano AR che ospiterà la texture video -->
        <a-plane id="video-plane" position="0 1.5 -3" rotation="0 0 0" width="2" height="1.125" color="grey">
            <!-- La texture video verrà applicata in JS -->
        </a-plane>

        <!-- Fotocamera -->
        <a-camera></a-camera>

    </a-scene>

    <!-- Pulsante Play -->
    <div id="play-container" style="text-align: center; position: fixed; width: 100%; top: 50%; z-index: 10;">
        <button id="play-button" style="padding: 20px; background-color: #33cc33; color: white; font-size: 20px;">Play</button>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', function () {
            var playButton = document.querySelector('#play-button');
            var videoPlane = document.querySelector('#video-plane');

            // Crea un elemento video HTML5
            var videoElement = document.createElement('video');
            videoElement.src = 'https://simoneg292.github.io/file-di-prova/blink-182%20-%20Feeling%20This%20(Official%20Video).mp4';
            videoElement.loop = true;  // Opzionale: fa partire il video in loop
            videoElement.setAttribute('crossorigin', 'anonymous'); // Per evitare errori di CORS

            // Crea una texture per il video
            var videoTexture = new THREE.VideoTexture(videoElement);

            // Gestione del clic sul pulsante Play
            playButton.addEventListener('click', function () {
                // Applica la texture video al piano AR
                videoPlane.setAttribute('material', 'src', videoTexture);

                // Avvia il video
                videoElement.play().then(() => {
                    console.log("Video partito correttamente");
                }).catch((error) => {
                    console.error("Errore nell'avvio del video: ", error);
                });

                // Nascondi il pulsante Play
                playButton.style.display = 'none';
            });
        });
    </script>

</body>
</html>
